<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/animation.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="git+https://github.com/pakastin/frzr.git">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/animation.js~Animation.html">Animation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/observable.js~Observable.html">Observable</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/view.js~View.html">View</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/viewlist.js~ViewList.html">ViewList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-el">el</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prefix">prefix</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-raf">raf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-translate">translate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-each">each</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-eachCSS">eachCSS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-extendable">extendable</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isDefined">isDefined</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-shuffle">shuffle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ease">ease</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ViewOptions">ViewOptions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ViewListOptions">ViewListOptions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-external">E</span><span data-ice="name"><span><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement">HTMLElement</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/animation.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">
import { Observable } from &apos;./observable&apos;;
import { ease } from &apos;./easing&apos;;
import { raf } from &apos;./raf&apos;;

const animations = [];
let ticking;

/**
 * Simple but efficient animation helper with batched requestAnimationFrame
 */
export class Animation extends Observable {
  /**
   * Create new Animation
   * @param  {Number}     [delay=0]     Start delay in milliseconds
   * @param  {Number}     [duration=0]  Duration in milliseconds
   * @param  {String}     [easing=&apos;quadOut&apos;]      Possible values: &apos;linear&apos;, &apos;quadIn&apos;, &apos;quadOut&apos;, &apos;quadInOut&apos;, &apos;cubicIn&apos;, &apos;cubicOut&apos;, &apos;cubicInOut&apos;, &apos;quartIn&apos;, &apos;quartOut&apos;, &apos;quartInOut&apos;, &apos;quintIn&apos;, &apos;quintOut&apos;, &apos;quintInOut&apos;, &apos;bounceIn&apos;, &apos;bounceOut&apos;, &apos;bounceInOut&apos;
   * @param  {Function}   [init]          &apos;init&apos; event handler
   * @param  {Function}   [start]         &apos;start&apos; event handler
   * @param  {Function}   [progress]      &apos;progress&apos; event handler
   * @param  {Function}   [end]           &apos;end&apos; event handler
   * @return {Animation}
   */
  constructor ({ delay = 0, duration = 0, easing = ease.quadOut, init, start, progress, end }) {
    super();

    const now = Date.now();

    /**
     * Calculate when to start the animation
     * @type {Number}
     */
    this.startTime = now + delay;
    /**
     * Calculate when to end the animation
     * @type {Number}
     */
    this.endTime = this.startTime + duration;
    /**
     * Which easing to use
     * @type {String}
     */
    this.easing = easing;
    /**
     * Is animation started?
     * @type {Boolean}
     */
    this.started = false;

    if (init) this.on(&apos;init&apos;, init);
    if (start) this.on(&apos;start&apos;, start);
    if (progress) this.on(&apos;progress&apos;, progress);
    if (end) this.on(&apos;end&apos;, end);

    // add animation
    animations.push(this);

    this.trigger(&apos;init&apos;);

    if (!ticking) {
      // start ticking
      ticking = true;
      raf(tick);
    }
  }
  /**
   * Destroy the animation
   */
  destroy () {
    for (let i = 0; i &lt; animations.length; i++) {
      if (animations[i] === this) {
        animations.splice(i, 1);
        return;
      }
    }
  }
}

function tick () {
  const now = Date.now();

  if (!animations.length) {
    // stop ticking
    ticking = false;
    return;
  }

  for (let i = 0; i &lt; animations.length; i++) {
    const animation = animations[i];

    if (now &lt; animation.startTime) {
      // animation not yet started..
      continue;
    }
    if (!animation.started) {
      // animation starts
      animation.started = true;
      animation.trigger(&apos;start&apos;);
    }
    // animation progress
    let t = (now - animation.startTime) / (animation.endTime - animation.startTime);
    if (t &gt; 1) {
      t = 1;
    }
    animation.trigger(&apos;progress&apos;, animation.easing(t), t);
    if (now &gt; animation.endTime) {
      // animation ended
      animation.trigger(&apos;end&apos;);
      animations.splice(i--, 1);
      continue;
    }
  }
  raf(tick, true);
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.3)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
